class(admin3_list)
names(admin3_list)
View(admin3_list)
admin3_list <- data.frame(divipola$CÃ³digo.Municipio, divipola$Nombre.Municipio)
admin3_list <- unique(admin3_list)
names(admin3_list) <- c('admin3', 'admin3_name')
admin3_list$hdx_pcode <- paste0(iso3, admin3_list$admin3)
View(admin3_list)
admin4_list <- data.frame(divipola$CÃ³digo.Centro.Poblado, divipola$Nombre.Centro.Poblado)
admin4_list <- unique(admin4_list)
names(admin3_list) <- c('admin4', 'admin4_name')
admin4_list$hdx_pcode <- paste0(iso3, admin4_list$admin4)
View(admin4_list)
admin4_list$admin4
names(admin4_list)
names(admin4_list) <- c('admin4', 'admin4_name')
admin4_list$hdx_pcode <- paste0(iso3, admin4_list$admin4)
View(admin4_list)
setwd("~/Documents/Programming/cap_appeals")
url <- 'https://www.humanitarianresponse.info/clusters/countries'
doc <- htmlTreeParse(getURL(url), useInternal = TRUE)
clusters <- xpathApply(doc, "//table[@class='views-table cols-3']", xmlValue)
library(XML)
library(RCurl)
# base url
url <- 'https://www.humanitarianresponse.info/clusters/countries'
doc <- htmlTreeParse(getURL(url), useInternal = TRUE)
clusters <- xpathApply(doc, "//table[@class='views-table cols-3']", xmlValue)
clusters
doc
# base url
url <- 'http://www.unocha.org/cap/appeals/by-appeal/resultss'
doc <- htmlTreeParse(getURL(url), useInternal = TRUE)
clusters <- xpathApply(doc, "//table[@class='views-table cols-3']", xmlValue)
clusters
doc
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
doc
View(doc)
doc <- htmlTreeParse(getURL(url), useInternal = TRUE)
clusters <- xpathApply(doc, "//table", xmlValue)
clusters
clusters <- xpathApply(doc, "//th[@class='views-field views-field-title']", xmlValue)
clusters
clusters <- xpathApply(doc, "///table[@class='views-field views-field-title']", xmlValue)
clusters
clusters <- xpathApply(doc, "/table[@class='views-field views-field-title']", xmlValue)
clusters
clusters <- xpathApply(doc, "/table[@class='views-table cols-3']", xmlValue)
res <- xpathApply(doc, "/table[@class='views-table cols-3']", xmlValue)
res
res <- xpathApply(doc, "///table[@class='views-table cols-3']", xmlValue)
res
res <- xpathApply(doc, "//div[@class='view view-appeals-by-appeal-view view-id-appeals_by_appeal_view view-display-id-default view-dom-id-1']", xmlValue)
res
doc
url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
doc <- htmlTreeParse(getURL(url), useInternal = TRUE)
res <- xpathApply(doc, "//div[@class='view view-appeals-by-appeal-view view-id-appeals_by_appeal_view view-display-id-default view-dom-id-1']", xmlValue)
res
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
doc
View(readHTMLTable)
View(doc)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
url <- paste0(base_url, page, i)
url <- paste0(base_url, page, 1)
url
names(doc)
View(doc)
class(doc)
doc[1]
x <- data.frame(doc)
view(x)
View(x)
names(x)
list <- data.frame(z)
downloadCAPs <- function() {
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(0 in 10) {
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
if (i == 1) z <- doc
else z <- rbind(z, doc)
}
list <- data.frame(z)
list <- list[1]
names(list) <- 'Document Name'
# base url
#
# 	for (i in 0:10) {  # for the 11 pages.
# 		url <- paste0(base_url, page, i)
# 		a <- fromJSON(getURL(url))
# 		if (i == 1) z <- a
# 		else z <- rbind(z, a)
# 	}
return(list)
}
downloadCAPs <- function() {
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(0 in 10) {
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
if (i == 1) z <- doc
else z <- rbind(z, doc)
}
list <- data.frame(z)
list <- list[1]
names(list) <- 'Document Name'
return(list)
}
downloadCAPs <- function() {
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(i in 0:10) {
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
if (i == 1) z <- doc
else z <- rbind(z, doc)
}
list <- data.frame(z)
list <- list[1]
names(list) <- 'Document Name'
return(list)
}
x <- downloadCAPs()
downloadCAPs <- function() {
message('Assembling a list of CAP documents.')
pb <- txtProgressBar(min = 0, max = 10, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(i in 0:10) {
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
if (i == 0) z <- doc
else z <- rbind(z, doc)
}
list <- data.frame(z)
list <- list[1]
names(list) <- 'Document Name'
message('Done.')
return(list)
}
x <- downloadCAPs()
View(z)
View(x)
downloadCAPs <- function() {
message('Assembling a list of CAP documents.')
pb <- txtProgressBar(min = 0, max = 10, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(i in 0:1) {
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
if (i == 0) z <- doc
else z <- rbind(z, doc)
}
list <- data.frame(z)
list <- list[1]
names(list) <- 'Document Name'
message('Done.')
return(list)
}
x <- downloadCAPs()
View(x)
downloadCAPs <- function() {
message('Assembling a list of CAP documents.')
pb <- txtProgressBar(min = 0, max = 10, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(i in 0:1) {
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
if (i == 0) z <- data.frame(doc)
else z <- rbind(z, doc)
}
list <- data.frame(z)
list <- list[1]
names(list) <- 'Document Name'
message('Done.')
return(list)
}
x <- downloadCAPs()
downloadCAPs <- function() {
message('Assembling a list of CAP documents.')
pb <- txtProgressBar(min = 0, max = 10, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(i in 0:1) {
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
if (i == 0) z <- data.frame(doc)
else z <- rbind(z, data.frame(doc))
}
list <- data.frame(z)
list <- list[1]
names(list) <- 'Document Name'
message('Done.')
return(list)
}
x <- downloadCAPs()
downloadCAPs <- function() {
message('Assembling a list of CAP documents.')
pb <- txtProgressBar(min = 0, max = 10, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(i in 0:1) {
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
doc <- data.frame(doc)
if (i == 0) z <- doc
else z <- rbind(z, doc)
}
list <- data.frame(z)
list <- list[1]
names(list) <- 'Document Name'
message('Done.')
return(list)
}
x <- downloadCAPs()
downloadCAPs <- function() {
message('Assembling a list of CAP documents.')
pb <- txtProgressBar(min = 0, max = 10, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(i in 0:1) {
setTxtProgressBar(pb, 1)
url <- paste0(base_url, page, 1)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
doc <- data.frame(doc)
if (i == 0) z <- doc
else z <- rbind(z, doc)
}
list <- data.frame(z)
list <- list[1]
names(list) <- 'Document Name'
message('Done.')
return(list)
}
x <- downloadCAPs()
doc <- data.frame(doc)
downloadCAPs <- function() {
message('Assembling a list of CAP documents.')
pb <- txtProgressBar(min = 0, max = 10, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(i in 0:1) {
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
doc <- data.frame(doc)
if (i == 0) z <- doc
else z <- rbind(z, doc)
}
list <- data.frame(z)
list <- list[1]
names(list) <- 'Document Name'
message('Done.')
return(list)
}
x <- downloadCAPs()
View(x)
downloadCAPs <- function() {
message('Assembling a list of CAP documents.')
pb <- txtProgressBar(min = 0, max = 10, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(i in 0:10) {
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
doc <- data.frame(doc)
if (i == 0) z <- doc
else z <- rbind(z, doc)
}
list <- data.frame(z)
list <- list[1]
names(list) <- 'Document Name'
message('Done.')
return(list)
}
x <- downloadCAPs()
downloadCAPs <- function(verbose = TRUE) {
message('Assembling a list of CAP documents.')
pb <- txtProgressBar(min = 0, max = 10, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(i in 0:10) {
if (verbose = TRUE) message(paste('Page:', i))
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
doc <- data.frame(doc)
if (i == 0) z <- doc
else z <- rbind(z, doc)
}
list <- data.frame(z)
list <- list[1]
names(list) <- 'Document Name'
message('Done.')
return(list)
}
x <- downloadCAPs()
downloadCAPs <- function(verbose = TRUE) {
message('Assembling a list of CAP documents.')
pb <- txtProgressBar(min = 0, max = 10, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(i in 0:10) {
if (verbose == TRUE) message(paste('Page:', i))
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
doc <- data.frame(doc)
if (i == 0) z <- doc
else z <- rbind(z, doc)
}
list <- data.frame(z)
list <- list[1]
names(list) <- 'Document Name'
message('Done.')
return(list)
}
x <- downloadCAPs()
downloadCAPs <- function(verbose = TRUE) {
message('Assembling a list of CAP documents.')
pb <- txtProgressBar(min = 0, max = 10, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(i in 0:10) {
if (verbose == TRUE) message(paste('Page:', i))
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
doc <- data.frame(doc)
doc <- doc[1]
if (i == 0) list <- doc
else list <- rbind(list, doc)
}
names(list) <- 'Document Name'
message('Done.')
return(list)
}
x <- downloadCAPs()
downloadCAPs <- function(verbose = TRUE) {
message('Assembling a list of CAP documents.')
pb <- txtProgressBar(min = 0, max = 10, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(i in 0:10) {
if (verbose == TRUE) message(paste('Page:', i))
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
doc <- data.frame(doc)
doc <- doc[1]
colnames(doc)[1] <- 'Document Name'
if (i == 0) list <- doc
else list <- rbind(list, doc)
}
names(list) <- 'Document Name'
message('Done.')
return(list)
}
x <- downloadCAPs()
downloadCAPs <- function(verbose = TRUE) {
message('Assembling a list of CAP documents.')
pb <- txtProgressBar(min = 0, max = 10, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# for a list of items
for(i in 0:6) {
if (verbose == TRUE) message(paste('Page:', i))
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
doc <- data.frame(doc)
doc <- doc[1]
colnames(doc)[1] <- 'Document Name'
if (i == 0) list <- doc
else list <- rbind(list, doc)
}
names(list) <- 'Document Name'
message('Done.')
return(list)
}
x <- downloadCAPs()
View(x)
downloadCAPs <- function(verbose = TRUE) {
message('Assembling a list of CAP documents.')
pb <- txtProgressBar(min = 0, max = 10, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# CAP appeals go until page 6
for(i in 0:6) {
if (verbose == TRUE) message(paste('Page:', i))
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
doc <- data.frame(doc)
doc <- doc[1]
colnames(doc)[1] <- 'Document Name'
if (i == 0) list <- doc
else list <- rbind(list, doc)
}
names(list) <- 'Document Name'
list$appeal_type <- 'Consolidated Appeal'
message('Done.')
return(list)
}
x <- downloadCAPs()
VieW(x)
View(x)
list <- downloadCAPs()
downloadAppeals <- function(verbose = FALSE) {
message('Assembling a list of CAP documents.')
message('Downloading CAP documents.')
pb <- txtProgressBar(min = 0, max = 6, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# CAP appeals go until page 6
for(i in 0:6) {
if (verbose == TRUE) message(paste('Page:', i))
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
doc <- data.frame(doc)
doc <- doc[1]
colnames(doc)[1] <- 'Document Name'
if (i == 0) cap_list <- doc
else cap_list <- rbind(cap_list, doc)
}
names(cap_list) <- 'Document Name'
cap_list$appeal_type <- 'Consolidated Appeal'
# Flash appeals from page 6 until page 8
message('Downloading Flash appeals documents.')
pb <- txtProgressBar(min = 6, max = 8, style = 3)
for(i in 6:8){
setTxtProgressBar(pb, i)
}
# Other appeals from page 8 until page 9
message('Downloading other appeals documents.')
pb <- txtProgressBar(min = 6, max = 8, style = 3)
for(i in 6:8){
setTxtProgressBar(pb, i)
}
message('Done.')
return(list)
}
list <- downloadAppeals()
VieW(list)
View(list)
list
class(list)
downloadAppeals <- function(verbose = FALSE) {
message('Assembling a list of CAP documents.')
message('Downloading CAP documents.')
pb <- txtProgressBar(min = 0, max = 6, style = 3)
base_url <- 'http://www.unocha.org/cap/appeals/by-appeal/results'
page <- '?page='  # 492 appeals in 11 pages -- starts at 0.
# CAP appeals go until page 6
for(i in 0:6) {
if (verbose == TRUE) message(paste('Page:', i))
setTxtProgressBar(pb, i)
url <- paste0(base_url, page, i)
doc <- readHTMLTable(getURL(url), useInternal = TRUE)
doc <- data.frame(doc)
doc <- doc[1]
colnames(doc)[1] <- 'Document Name'
if (i == 0) cap_list <- doc
else cap_list <- rbind(cap_list, doc)
}
names(cap_list) <- 'Document Name'
cap_list$appeal_type <- 'Consolidated Appeal'
# Flash appeals from page 6 until page 8
message('Downloading Flash appeals documents.')
pb <- txtProgressBar(min = 6, max = 8, style = 3)
for(i in 6:8){
setTxtProgressBar(pb, i)
}
# Other appeals from page 8 until page 9
message('Downloading other appeals documents.')
pb <- txtProgressBar(min = 6, max = 8, style = 3)
for(i in 6:8){
setTxtProgressBar(pb, i)
}
message('Done.')
return(cap_list)
}
